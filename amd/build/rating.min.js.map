{"version":3,"file":"rating.min.js","sources":["../src/rating.js"],"sourcesContent":["/**\n * Convert boostrap alert to sweetalert.\n *\n * @package\n * @subpackage    mod_evokeportfolio\n * @copyright  2021 World Bank Group <https://worldbank.org>\n * @author     Willian Mano <willianmanoaraujo@gmail.com>\n */\n\nimport {add as addToast} from 'core/toast';\nimport Ajax from 'core/ajax';\n\nexport const init = () => {\n    document.querySelectorAll('.star-rating:not(.readonly) label').forEach(star => {\n        star.addEventListener('click', function(event) {\n            this.style.transform = 'scale(1.2)';\n\n            setTimeout(() => {\n                this.style.transform = 'scale(1)';\n            }, 200);\n\n            sendRating(event.target.dataset.entryid, event.target.dataset.rate);\n        });\n    });\n};\n\nconst sendRating = (entryid, rate) => {\n    var request = Ajax.call([{\n        methodname: 'mod_proposal_rate',\n        args: {\n            entryid: entryid,\n            rate: rate\n        }\n    }]);\n\n    request[0].done(function(response) {\n        const elm = document.getElementById('average-badge-div-' + entryid);\n        elm.innerHTML = response.rate;\n        addToast('Avaliação enviada', {type: 'success'});\n    }.bind(this)).fail(function(error) {\n        window.console.log(error);\n        var message = error.message;\n\n        if (!message) {\n            message = error.error;\n        }\n\n        addToast(message, {type: 'danger'});\n    });\n};"],"names":["document","querySelectorAll","forEach","star","addEventListener","event","style","transform","setTimeout","sendRating","target","dataset","entryid","rate","Ajax","call","methodname","args","done","response","getElementById","innerHTML","type","bind","fail","error","window","console","log","message"],"mappings":"0PAYoB,KAChBA,SAASC,iBAAiB,qCAAqCC,SAAQC,OACnEA,KAAKC,iBAAiB,SAAS,SAASC,YAC/BC,MAAMC,UAAY,aAEvBC,YAAW,UACFF,MAAMC,UAAY,aACxB,KAEHE,WAAWJ,MAAMK,OAAOC,QAAQC,QAASP,MAAMK,OAAOC,QAAQE,mBAKpEJ,WAAa,CAACG,QAASC,QACXC,cAAKC,KAAK,CAAC,CACrBC,WAAY,oBACZC,KAAM,CACFL,QAASA,QACTC,KAAMA,SAIN,GAAGK,KAAK,SAASC,UACTnB,SAASoB,eAAe,qBAAuBR,SACvDS,UAAYF,SAASN,oBAChB,oBAAqB,CAACS,KAAM,aACvCC,cAAYC,MAAK,SAASC,OACxBC,OAAOC,QAAQC,IAAIH,WACfI,QAAUJ,MAAMI,QAEfA,UACDA,QAAUJ,MAAMA,sBAGXI,QAAS,CAACP,KAAM"}